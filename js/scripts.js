document.addEventListener('DOMContentLoaded', function() {
    // Intersection Observer pentru anima»õii
    const animateOnScroll = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = "1";
                entry.target.style.transform = "translateY(0)";
            }
        });
    });

    // Animate elements with data-animate attribute
    document.querySelectorAll('[data-animate]').forEach(el => {
        el.style.opacity = "0";
        el.style.transform = "translateY(30px)";
        el.style.transition = "all 0.6s cubic-bezier(0.4, 0, 0.2, 1)";
        animateOnScroll.observe(el);
    });

    // Efect navbar la scroll
    window.addEventListener('scroll', function() {
        const navbar = document.querySelector('.navbar');
        if (window.scrollY > 50) {
            navbar.style.boxShadow = "0 4px 20px rgba(0,0,0,0.08)";
        } else {
            navbar.style.boxShadow = "0 2px 10px rgba(0,0,0,0.1)";
        }
    });

    // Contor animat - MODIFICAT pentru a func»õiona corect
    function animateCounter(element, finalValue, duration) {
        let start = null;
        const initial = 0; // For»õƒÉm pornirea de la 0
        element.textContent = initial; // ResetƒÉm valoarea ini»õialƒÉ
        
        const step = (timestamp) => {
            if (!start) start = timestamp;
            const progress = timestamp - start;
            const percentage = Math.min(progress / duration, 1);
            element.textContent = Math.floor(initial + (finalValue - initial) * percentage);
            if (percentage < 1) window.requestAnimationFrame(step);
        };
        
        window.requestAnimationFrame(step);
    }

    // Ini»õializare grafice - ADAUGAT Grafic Cerere/OfertƒÉ
    function initCharts() {
        const rootStyles = getComputedStyle(document.documentElement);
        const primaryBlue = rootStyles.getPropertyValue('--primary-blue').trim();
        const accentTeal = rootStyles.getPropertyValue('--accent-teal').trim();
        const secondaryBlue = rootStyles.getPropertyValue('--secondary-blue').trim();

        // Grafic Cerere »ôi OfertƒÉ
        const supplyDemandCtx = document.getElementById('supplyDemandChart')?.getContext('2d');
        if (supplyDemandCtx) {
            new Chart(supplyDemandCtx, {
                type: 'line',
                data: {
                    labels: ['Q1', 'Q2', 'Q3', 'Q4'],
                    datasets: [
                        {
                            label: 'Cerere',
                            data: [65, 59, 80, 81],
                            borderColor: primaryBlue,
                            tension: 0.4
                        },
                        {
                            label: 'OfertƒÉ',
                            data: [80, 55, 60, 70],
                            borderColor: '#e74c3c',
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    }
                }
            });
        }

        // Grafic PIB
        const gdpCtx = document.getElementById('gdpChart')?.getContext('2d');
        if (gdpCtx) {
            new Chart(gdpCtx, {
                type: 'line',
                data: {
                    labels: ['2018', '2019', '2020', '2021', '2022'],
                    datasets: [{
                        label: 'PIB Rom√¢nia (miliarde EUR)',
                        data: [202, 218, 200, 230, 250],
                        borderColor: primaryBlue,
                        tension: 0.4
                    }]
                }
            });
        }

        // Grafic infla»õie
        const inflationCtx = document.getElementById('inflationChart')?.getContext('2d');
        if (inflationCtx) {
            new Chart(inflationCtx, {
                type: 'bar',
                data: {
                    labels: ['2019', '2020', '2021', '2022', '2023'],
                    datasets: [{
                        label: 'Infla»õie (%)',
                        data: [3.8, 2.6, 5.1, 13.8, 9.4],
                        backgroundColor: accentTeal
                    }]
                }
            });
        }
    }

    // Ini»õializare componente
    const counterElement = document.querySelector('.counter');
    if (counterElement) {
        animateCounter(counterElement, 100, 2000);
    }

    // Ini»õializeazƒÉ toate graficele
    initCharts();

    // Mobile dropdown functionality
    const dropdownToggles = document.querySelectorAll('.dropdown-toggle');
    dropdownToggles.forEach(toggle => {
        toggle.addEventListener('click', function(e) {
            e.preventDefault();
            const dropdown = this.parentElement;
            dropdown.classList.toggle('show');
        });
    });

    // Close dropdowns when clicking outside
    document.addEventListener('click', function(e) {
        dropdownToggles.forEach(toggle => {
            const dropdown = toggle.parentElement;
            if (!dropdown.contains(e.target)) {
                dropdown.classList.remove('show');
            }
        });
    });

    // Toggle sisteme economice - VERSIUNE CORECTATƒÇ
    const systemToggle = document.getElementById('systemToggle');
    const marketExample = document.getElementById('marketExample');
    const plannedExample = document.getElementById('plannedExample');

    if (systemToggle && marketExample && plannedExample) {
        // Ini»õializare stare
        let isMarketActive = true;
        
        // Ascunde initi√°l economia planificatƒÉ
        plannedExample.classList.remove('active');
        
        systemToggle.addEventListener('click', () => {
            isMarketActive = !isMarketActive;
            
            // ActualizeazƒÉ vizibilitatea
            marketExample.classList.toggle('active', isMarketActive);
            plannedExample.classList.toggle('active', !isMarketActive);
            
            // ActualizeazƒÉ textul butonului
            systemToggle.textContent = isMarketActive 
                ? 'AratƒÉ Economie PlanificatƒÉ' 
                : 'AratƒÉ Economie de Pia»õƒÉ';
        });
    }

    // ADAUGAT: Hover efect pentru timeline
    const timelineItems = document.querySelectorAll('.timeline-item');
    timelineItems.forEach(item => {
        item.addEventListener('mouseenter', () => {
            item.querySelector('.timeline-content').style.transform = 'scale(1.05)';
        });
        item.addEventListener('mouseleave', () => {
            item.querySelector('.timeline-content').style.transform = 'scale(1)';
        });
    });

    // ADAUGAT: Interac»õiune cu diagrama de resurse
    const pieSlices = document.querySelectorAll('.pie-chart .slice');
    pieSlices.forEach(slice => {
        slice.addEventListener('mouseenter', () => {
            slice.style.filter = 'brightness(1.1)';
            slice.style.transform = 'scale(1.05)';
        });
        slice.addEventListener('mouseleave', () => {
            slice.style.filter = 'brightness(1)';
            slice.style.transform = 'scale(1)';
        });
    });
    const resourcesCtx = document.getElementById('resourcesChart')?.getContext('2d');
    if (resourcesCtx) {
        new Chart(resourcesCtx, {
            type: 'pie',
            data: {
                labels: ['Naturale', 'Umane', 'Capital'],
                datasets: [{
                    label: 'Tipuri de Resurse',
                    data: [60, 30, 10],
                    backgroundColor: [
                        '#2B50EC', // naturale
                        '#1A936F', // umane
                        '#6B8EFF'  // capital
                    ],
                    borderColor: '#fff',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'right',
                        labels: {
                            color: '#2D3748',
                            font: {
                                size: 14
                            }
                        }
                    },
                    title: {
                        display: true,
                        text: 'Distribu»õia resurselor √Æn economie',
                        color: '#2B50EC',
                        font: {
                            size: 16
                        }
                    }
                }
            }
        });
    }
    // Toggle pentru sisteme economice + tabel »ôi descriere
    const buttons = document.querySelectorAll('.system-btn');
    const tabs = document.querySelectorAll('.system-tab'); // dacƒÉ ai taburi
    const tables = document.querySelectorAll('.system-table'); // fiecare tabel are data-type
    const systemDesc = document.getElementById('system-description');

    // Definim descrierile pentru fiecare sistem
    const descriptions = {
    free: '<strong>üìà Pia»õƒÉ LiberƒÉ:</strong> Pre»õurile se formeazƒÉ liber prin cerere »ôi ofertƒÉ. Statul intervine minim. Exemple: SUA, Germania.',
    planned: '<strong>üèõÔ∏è PlanificatƒÉ:</strong> Statul controleazƒÉ √Æntreaga economie ‚Äì de la produc»õie la pre»õuri. Exemple: Coreea de Nord.',
    mixed: '<strong>‚öñÔ∏è MixtƒÉ:</strong> Combina»õie √Æntre libertate de pia»õƒÉ »ôi interven»õie guvernamentalƒÉ. Exemple: Rom√¢nia, Fran»õa.'
    };

    console.log('Sistem de toggle ini»õializat.');

    // AscultƒÉm click pe fiecare buton
    buttons.forEach(btn => {
    btn.addEventListener('click', () => {
        const system = btn.dataset.system;
        console.log('ApƒÉsat pe sistem:', system);

        // 1. Active state pentru butoane
        buttons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');

        // 2. Taburi (dacƒÉ ai √Æn cod)
        tabs.forEach(tab => {
        tab.classList.remove('active');
        console.log('Dezactivez tab:', tab.id);
        });

        const activeTab = document.getElementById(system);
        if (activeTab) {
        activeTab.classList.add('active');
        console.log('Activez tab:', system);
        }

        // 3. Tabele: afi»ôeazƒÉ doar tabelul potrivit
        tables.forEach(table => {
        const shouldShow = table.dataset.type === system;
        table.classList.toggle('hidden', !shouldShow);
        console.log(`Tabel ${table.dataset.type} ‚Üí ${shouldShow ? 'AFI»òAT' : 'ASCUNS'}`);
        });

        // 4. Descrierea
        if (systemDesc) {
        systemDesc.innerHTML = descriptions[system] || '';
        console.log('Descriere setatƒÉ pentru:', system);
        } else {
        console.warn('‚ö†Ô∏è Elementul #system-description nu existƒÉ!');
        }
    });
    });

    // Setare ini»õialƒÉ automatƒÉ la √ÆncƒÉrcare
    const defaultSystem = document.querySelector('.system-btn.active')?.dataset.system || 'free';
    if (systemDesc) {
    systemDesc.innerHTML = descriptions[defaultSystem];
    console.log('Descriere implicitƒÉ setatƒÉ:', defaultSystem);
    } else {
    console.warn('‚ö†Ô∏è Elementul #system-description lipse»ôte la ini»õializare!');
    }




    // Chart: distribu»õie sisteme pe continente
    const ctx = document.getElementById('economicSystemsChart')?.getContext('2d');
    if (ctx) {
    new Chart(ctx, {
        type: 'bar',
        data: {
        labels: ['Europa', 'America de Nord', 'Asia', 'Africa'],
        datasets: [
            {
            label: 'Pia»õƒÉ LiberƒÉ',
            data: [15, 20, 5, 2],
            backgroundColor: '#2B50EC'
            },
            {
            label: 'PlanificatƒÉ',
            data: [1, 0, 3, 1],
            backgroundColor: '#e74c3c'
            },
            {
            label: 'MixtƒÉ',
            data: [25, 10, 20, 15],
            backgroundColor: '#1A936F'
            }
        ]
        },
        options: {
        responsive: true,
        plugins: {
            legend: {
            position: 'top'
            },
            title: {
            display: true,
            text: 'Distribu»õia globalƒÉ a sistemelor economice'
            }
        }
        }
    });
    }
    // === Buget Personal ===
    let budgetChartInstance = null;

    const calculateBtn = document.getElementById('calculateBtn');
    if (calculateBtn) {
    calculateBtn.addEventListener('click', () => {
        const income = parseFloat(document.getElementById('income').value);
        const food = parseFloat(document.getElementById('food').value);
        const transport = parseFloat(document.getElementById('transport').value);
        const education = parseFloat(document.getElementById('education').value);
        const fun = parseFloat(document.getElementById('fun').value);
        const feedback = document.getElementById('feedbackMsg');
        const chartCanvas = document.getElementById('budgetChart');

        if (isNaN(income) || isNaN(food) || isNaN(transport) || isNaN(education) || isNaN(fun)) {
        alert('CompleteazƒÉ toate c√¢mpurile!');
        return;
        }

        const total = food + transport + education + fun;
        const rest = income - total;

        // Feedback text
        if (rest < 0) {
        feedback.textContent = "‚ö†Ô∏è Cheltuie»ôti mai mult dec√¢t c√¢»ôtigi!";
        feedback.style.color = "#e74c3c";
        } else if (rest < income * 0.1) {
        feedback.textContent = "‚ö†Ô∏è Ai foarte pu»õine economii. √éncearcƒÉ sƒÉ reduci cheltuielile.";
        feedback.style.color = "#f39c12";
        } else {
        feedback.textContent = "‚úÖ Bugetul tƒÉu este echilibrat!";
        feedback.style.color = "#1A936F";
        }

        if (budgetChartInstance) {
        budgetChartInstance.destroy();
        }

        budgetChartInstance = new Chart(chartCanvas, {
        type: 'bar',
        data: {
            labels: ['Alimente', 'Transport', 'Educa»õie', 'Divertisment', 'Economii'],
            datasets: [{
            label: 'Distribu»õia Bugetului (‚Ç¨)',
            data: [food, transport, education, fun, rest],
            backgroundColor: ['#2B50EC', '#6B8EFF', '#1A936F', '#f39c12', '#2ecc71']
            }]
        },
        options: {
            responsive: true,
            plugins: {
            legend: { display: false },
            title: {
                display: true,
                text: 'Structura bugetului personal'
            }
            }
        }
        });
    });
    }
    const toggleBtn = document.getElementById('menuToggle');
    const navLinks = document.getElementById('navLinks');

    toggleBtn?.addEventListener('click', () => {
        navLinks.classList.toggle('show');
  });
  const cards = document.querySelectorAll(".quiz-card");
  cards.forEach(card => {
    card.classList.add("fade-in");
  });
});
function showQuiz(id) {
    document.querySelectorAll(".quiz-section").forEach(q => q.classList.remove("active"));
    document.getElementById(id).classList.add("active");
    window.scrollTo({ top: 300, behavior: 'smooth' });
  }
  
  function checkQuiz(id, answers) {
    let score = 0;
    for (let q in answers) {
      const selected = document.querySelector(`#${id}Form input[name="${q}"]:checked`);
      if (selected && selected.value === answers[q]) score++;
    }
  
    const result = document.getElementById(`${id}Result`);
    let badge = "", message = "";
  
    if (score === 6) {
        badge = "gold";
        message = "Excelent! Ai rƒÉspuns corect la toate √ÆntrebƒÉrile!";
    } else if (score >= 4) {
        badge = "silver";
        message = "Foarte bine! Cuno»ôtin»õe solide ‚Äì mai ai pu»õin p√¢nƒÉ la perfec»õiune.";
    } else if (score >= 2) {
        badge = "bronze";
        message = "E un √Ænceput bun! ContinuƒÉ sƒÉ √Ænve»õi.";
    } else {
        badge = "try";
        message = "Nicio problemƒÉ ‚Äì √ÆncearcƒÉ din nou »ôi vei progresa!";
    }
      
  
    result.innerHTML = `Ai ob»õinut <strong>${score}/6</strong>. <span class="badge ${badge}">${message}</span>`;
  }
  
  const modal = document.getElementById("modal");
  const modalText = document.getElementById("modalText");
  
  function openModal(person) {
    const data = {
        smith: `
        <h3>Adam Smith</h3>
        <p><strong>PerioadƒÉ:</strong> Secolul XVIII | <strong>Lucrare fundamentalƒÉ:</strong> ‚ÄûAvu»õia Na»õiunilor‚Äù (1776)</p>
        <p>Considerat pƒÉrintele economiei moderne, Smith a introdus ideea cƒÉ indivizii, urmƒÉrindu-»ôi propriul interes, contribuie involuntar la binele comun ‚Äì concept cunoscut sub numele de <em>‚Äûm√¢na invizibilƒÉ‚Äù</em>.</p>
        <p>Promova libertatea economicƒÉ, proprietatea privatƒÉ, concuren»õa »ôi non-interven»õia statului √Æn pie»õe (laissez-faire). A fost primul care a sistematizat concepte precum specializarea muncii, diviziunea muncii »ôi rolul acumulƒÉrii de capital √Æn dezvoltarea economicƒÉ.</p>
        <p><strong>Influen»õƒÉ:</strong> A influen»õat major g√¢ndirea liberalƒÉ »ôi pe economi»ôti precum Friedman »ôi Hayek. A fost contestat de Marx pentru cƒÉ ignora inegalitƒÉ»õile sociale rezultate din pia»õa liberƒÉ.</p>
        <p><strong>Impact actual:</strong> Fundamentele economiilor capitaliste moderne se bazeazƒÉ √ÆncƒÉ pe conceptele sale despre pia»õƒÉ »ôi eficien»õƒÉ economicƒÉ.</p>
      `,
      marx: `
        <h3>Karl Marx</h3>
        <p><strong>PerioadƒÉ:</strong> Secolul XIX | <strong>Lucrare principalƒÉ:</strong> ‚ÄûCapitalul‚Äù (1867)</p>
        <p>Marx a fost filosof, economist »ôi sociolog. A criticat profund capitalismul, consider√¢ndu-l o sursƒÉ de exploatare a clasei muncitoare. A introdus concepte precum <em>lupta de clasƒÉ</em>, <em>alienarea muncitorului</em> »ôi <em>dictatura proletariatului</em>.</p>
        <p>A sus»õinut cƒÉ mijloacele de produc»õie ar trebui de»õinute colectiv, iar distribu»õia bunurilor sƒÉ fie echitabilƒÉ. √én opozi»õie directƒÉ cu Smith, Marx considera cƒÉ pia»õa liberƒÉ produce inegalitate »ôi crize ciclice inevitabile.</p>
        <p><strong>Influen»õƒÉ:</strong> A stat la baza ideologiei socialiste »ôi comuniste, influen»õ√¢nd politicile URSS, Chinei maoiste »ôi altor regimuri din secolul XX.</p>
        <p><strong>Impact actual:</strong> Criticile sale sunt √ÆncƒÉ folosite √Æn analiza inegalitƒÉ»õii economice »ôi a capitalismului globalizat. A influen»õat teoriile post-marxiste, economia criticƒÉ »ôi curentele antiglobalizare.</p>
        <p><strong>Rela»õia cu Smith:</strong> Marx l-a studiat »ôi l-a criticat pe Smith, consider√¢nd cƒÉ acesta idealiza pia»õa liberƒÉ fƒÉrƒÉ a analiza efectele sociale ale acumulƒÉrii de capital.</p>
        `,
    keynes: `
        <h3>John Maynard Keynes</h3>
        <p><strong>PerioadƒÉ:</strong> Secolul XX | <strong>Lucrare-cheie:</strong> ‚ÄûTeoria GeneralƒÉ a OcupƒÉrii For»õei de MuncƒÉ, a Dob√¢nzii »ôi a Banilor‚Äù (1936)</p>
        <p>A revolu»õionat economia modernƒÉ √Æn urma Marii Crize din 1929. A observat cƒÉ pie»õele nu se autoregleazƒÉ eficient √Æn perioade de crizƒÉ »ôi a propus interven»õia statului prin politici fiscale (cheltuieli guvernamentale, reduceri de taxe) pentru a stimula cererea »ôi a reduce »ôomajul.</p>
        <p><strong>Politica fiscalƒÉ contra-ciclicƒÉ</strong> ‚Äì un concept central keynesian ‚Äì presupune ca statul sƒÉ cheltuie mai mult √Æn crizƒÉ »ôi sƒÉ economiseascƒÉ √Æn perioade de cre»ôtere economicƒÉ.</p>
        <p><strong>Influen»õƒÉ:</strong> A stat la baza economiilor occidentale √Æn perioada postbelicƒÉ, √Æn special √Æn Europa »ôi SUA. Modelele FMI »ôi BƒÉncii Mondiale au fost influen»õate de Keynes.</p>
        <p><strong>Impact actual:</strong> G√¢ndirea sa a revenit √Æn prim-plan √Æn timpul crizelor financiare recente (2008, COVID-19), c√¢nd guvernele au intervenit masiv √Æn economie.</p>
        <p><strong>Pozi»õionare:</strong> √éntre Smith »ôi Marx. Nu respinge capitalismul, dar subliniazƒÉ limitele pie»õei libere »ôi necesitatea interven»õiei statului pentru stabilitate.</p>
      `,
      friedman: `
        <h3>Milton Friedman</h3>
        <p><strong>PerioadƒÉ:</strong> Secolul XX | <strong>Ideologie:</strong> Monetarism, Neoliberalism</p>
        <p>Friedman a fost cel mai influent economist liberal al secolului XX. A fost un critic dur al interven»õiei statului, sus»õin√¢nd cƒÉ pie»õele libere oferƒÉ cea mai bunƒÉ alocare a resurselor. A fost promotor al <em>monetarismului</em> ‚Äì ideea cƒÉ infla»õia este un fenomen monetar, controlabil prin cantitatea de bani √Æn economie.</p>
        <p>A pledat pentru dereglementare, privatizare, reducerea taxelor »ôi limitarea cheltuielilor guvernamentale.</p>
        <p><strong>Influen»õƒÉ:</strong> A influen»õat politicile economice din SUA sub Ronald Reagan »ôi √Æn Marea Britanie sub Margaret Thatcher. Modelele FMI √Æn anii ‚Äô80-‚Äô90 reflectƒÉ filosofia sa economicƒÉ.</p>
        <p><strong>Critici:</strong> A fost acuzat cƒÉ a generat cre»ôteri ale inegalitƒÉ»õii sociale »ôi cƒÉ a sus»õinut regimuri autoritare care aplicau politici de pia»õƒÉ (ex: Chile √Æn timpul lui Pinochet).</p>
        <p><strong>Impact actual:</strong> Multe reforme de tip ‚Äûausteritate‚Äù »ôi politici de ‚Äûpia»õƒÉ liberƒÉ‚Äù din »õƒÉrile √Æn dezvoltare au avut la bazƒÉ g√¢ndirea sa.</p>
        <p><strong>Rela»õie cu Keynes:</strong> Opozi»õie directƒÉ. A considerat interven»õiile keynesiene ca fiind periculoase pentru echilibrul pe termen lung.</p>
        `,

    };
    modalText.innerHTML = data[person];
    modal.classList.remove("hidden");
  }
  
  function closeModal() {
    modal.classList.add("hidden");
  }
  